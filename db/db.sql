USE [master];
DROP DATABASE IF EXISTS TestSalinasGroup;

CREATE DATABASE TestSalinasGroup;

USE TestSalinasGroup;

IF EXISTS(SELECT 1 FROM sys.tables WHERE object_id = OBJECT_ID('TA_SMS_DETALLE'))
BEGIN;
    DROP TABLE [TA_SMS_DETALLE];
END;


IF EXISTS(SELECT 1 FROM sys.tables WHERE object_id = OBJECT_ID('TA_SMS_MAESTRO'))
BEGIN;
    DROP TABLE [TA_SMS_MAESTRO];
END;
GO

CREATE TABLE [TA_SMS_MAESTRO] (
    [ID_campaign] INTEGER NOT NULL IDENTITY(1, 1),
    [campaign_name] VARCHAR(255) NULL,
    [fecha] Date NULL,
    PRIMARY KEY ([ID_campaign])
);
GO

GO

CREATE TABLE [TA_SMS_DETALLE] (
    [ID_detalle] INTEGER NOT NULL IDENTITY(1, 1),
    [seller] VARCHAR(255) NULL,
    [total] VARCHAR(100) NULL,
    [country] VARCHAR(255) NULL,
    [ID_campaign] INTEGER FOREIGN KEY REFERENCES TA_SMS_MAESTRO(ID_campaign),
    PRIMARY KEY ([ID_detalle])
);
GO

INSERT INTO [TA_SMS_MAESTRO] (campaign_name,fecha)
VALUES
  ('Amet Limited','2021-12-12'),
  ('Arcu Vel PC','2022-05-04'),
  ('Mollis Foundation','2021-11-11'),
  ('Aliquet Libero Foundation','2022-03-19'),
  ('Tincidunt Ltd','2021-07-17'),
  ('Integer Sem Institute','2022-03-29'),
  ('Molestie Arcu LLC','2021-12-16'),
  ('Amet Orci Incorporated','2021-04-09'),
  ('Scelerisque Mollis LLP','2021-06-18'),
  ('Volutpat Nulla Foundation','2022-05-15'),
  ('Sit Industries','2021-05-22'),
  ('Amet Risus LLC','2022-01-11'),
  ('Lorem Eu Institute','2021-07-16'),
  ('Pretium Neque LLC','2021-12-12'),
  ('Metus Inc.','2022-05-04'),
  ('Donec Porttitor Tellus Incorporated','2021-11-11'),
  ('Montes Inc.','2021-07-17'),
  ('Risus A Associates','2022-05-15'),
  ('Sed Associates','2021-05-22'),
  ('Sociis Natoque Institute','2021-07-16'),
  ('Egestas A Scelerisque Incorporated','2021-04-09'),
  ('Placerat Augue Sed Ltd','2021-06-18'),
  ('Rhoncus Limited','2021-12-12'),
  ('Cras Dictum Industries','2022-05-04'),
  ('Eget Limited','2021-11-11');


INSERT INTO [TA_SMS_DETALLE] (seller,total,country,ID_campaign)
VALUES
  ('Shellie Fox','$24.96','Hong Kong',24),
  ('Jasmine Dennis','$30.97','HŽvillers',4),
  ('Rina Robbins','$92.05','Multan',14),
  ('Macy Haney','$33.92','Berlin',17),
  ('Vanna Lopez','$46.73','Castellafiume',5),
  ('Evangeline Franklin','$23.77','Villa del Rosario',6),
  ('Lewis Riggs','$26.70','Tarbes',18),
  ('Chelsea Hooper','$98.29','Chimbote',12),
  ('Irene Carney','$73.44','San Andrés',19),
  ('Kirsten Mcfarland','$9.98','Owensboro',11),
  ('Hu Miles','$74.19','Chełm',4),
  ('Raven Morton','$57.46','Launceston',14),
  ('Drake Schroeder','$33.30','Villahermosa',12),
  ('Joshua Howard','$60.83','Carmen',9),
  ('Kennedy Floyd','$1.69','Sungai Penuh',15),
  ('Emily Henderson','$58.00','Shimla',5),
  ('Leroy Lindsay','$84.12','Ferlach',12),
  ('Giacomo Woodward','$18.45','Picture Butte',9),
  ('Bevis Fowler','$33.73','Suwałki',18),
  ('Upton Everett','$65.53','Elbląg',22),
  ('Kylan Ramos','$7.40','Kapfenberg',19),
  ('Gray Morrison','$1.66','Lelystad',16),
  ('Deanna Baldwin','$31.58','Sakhalin',9),
  ('Xaviera Rutledge','$42.51','Harstad',1),
  ('Darius Hill','$22.66','Bogotá',10),
  ('Barry Espinoza','$24.46','Poza Rica',4),
  ('Jamal Singleton','$40.01','Sint-Pieters-Woluwe',6),
  ('Ishmael Freeman','$40.39','Velden am Wörther See',13),
  ('Steven Bridges','$54.55','Ceyhan',19),
  ('Dorian Valencia','$11.65','Sainte-Marie-sur-Semois',21),
  ('Tarik Hernandez','$71.83','Mango',11),
  ('Ronan Dennis','$64.77','Puntarenas',22),
  ('Wing Mathews','$13.64','Ternate',23),
  ('Kibo Schultz','$46.75','Hennigsdorf',21),
  ('Isaiah Beard','$6.61','Ribeirão das Neves',20),
  ('Stacey Atkinson','$9.28','Sullana',15),
  ('Mufutau Yang','$4.74','Blumenau',24),
  ('Kameko Gregory','$3.33','Arequipa',7),
  ('Cynthia Bradley','$28.64','Vannes',16),
  ('Tucker Hayden','$0.62','Sant''Eufemia a Maiella',7),
  ('Patrick Hatfield','$40.52','Akron',4),
  ('Nash Shepard','$95.50','Łomża',5),
  ('Minerva Chang','$95.36','Morelia',8),
  ('Clementine Moody','$42.36','Ingraj Bazar',5),
  ('Fuller Cline','$74.57','Chester',13),
  ('Lev Cochran','$81.27','Diadema',4),
  ('Dominic Ferguson','$67.02','Miraflores',2),
  ('Althea Hooper','$15.74','Denpasar',2),
  ('Melinda Stout','$28.96','Cajamarca',21),
  ('Rashad Dunn','$79.60','Kaliningrad',10);
INSERT INTO [TA_SMS_DETALLE] (seller,total,country,ID_campaign)
VALUES
  ('Deanna Mason','$69.64','Canberra',20),
  ('Jada Snider','$91.37','Uddevalla',24),
  ('Shea Sykes','$55.75','Valle del Guamuez',18),
  ('Juliet Hester','$2.07','Bo''ness',13),
  ('Ciaran Medina','$30.05','Rancagua',23),
  ('Cody Russell','$65.76','Putaendo',16),
  ('Illana Horne','$61.08','Cressa',18),
  ('Lana Tucker','$59.52','Ålesund',3),
  ('Geoffrey Skinner','$25.27','Hamburg',19),
  ('Clementine Tate','$15.28','Matamata',20),
  ('Knox Mccullough','$28.32','Ahmedabad',7),
  ('Thane Gallegos','$91.50','Leduc',5),
  ('Willow Griffith','$19.88','Zeya',15),
  ('Kylynn Mercado','$18.71','Utrecht',12),
  ('Zelenia Clemons','$39.03','Brisbane',4),
  ('Chiquita Kirby','$87.42','Logan City',23),
  ('Demetria Lancaster','$6.62','Kupang',11),
  ('Nehru Griffin','$38.68','Canberra',19),
  ('Davis Charles','$90.38','GozŽe',16),
  ('Kessie Bradley','$7.54','Sokoto',2),
  ('Mannix Beasley','$59.96','Winterswijk',10),
  ('Talon Kent','$3.83','Cao Bằng',17),
  ('Quyn Foreman','$28.04','Limón (Puerto Limón]',22),
  ('Judah Estes','$10.62','San Antonio',2),
  ('Veronica Humphrey','$29.03','Elingen',19),
  ('Grant Tucker','$42.90','Frederikstad',8),
  ('Ray Hill','$66.59','Bagh',25),
  ('Tashya Lambert','$91.05','Cà Mau',3),
  ('Scott Hooper','$17.22','Victor Harbor',17),
  ('Curran Hubbard','$54.46','Motueka',17),
  ('Jermaine Huber','$25.45','Bhubaneswar',6),
  ('Martha Weaver','$97.87','Hidalgo del Parral',3),
  ('Karly Hayden','$80.59','El Tambo',21),
  ('Hakeem Hutchinson','$18.05','Armungia',5),
  ('Rahim Sosa','$24.42','Bydgoszcz',15),
  ('Roanna Murphy','$22.27','Dehradun',1),
  ('Aladdin Wheeler','$51.35','Gangtok',25),
  ('Shellie Ortiz','$7.19','Klagenfurt',17),
  ('Moses Graves','$25.31','Dorchester',25),
  ('Desirae Garrett','$99.26','Lago Verde',19),
  ('Nerea Butler','$6.64','Iqaluit',8),
  ('Melanie Wright','$59.49','Rockingham',3),
  ('Erin Booth','$88.42','Algeciras',15),
  ('Quin Flynn','$10.16','Cartagena',18),
  ('Quinlan Boone','$0.69','Leipzig',22),
  ('Jade Mendoza','$59.67','Abeokuta',6),
  ('Mechelle Little','$83.05','Badajoz',21),
  ('Wanda Bryan','$48.13','Corroy-le-Ch‰teau',3),
  ('Doris Burgess','$9.66','Sherborne',5),
  ('Cheyenne Patterson','$8.57','Warszawa',3);
INSERT INTO [TA_SMS_DETALLE] (seller,total,country,ID_campaign)
VALUES
  ('Hop Roman','$72.86','Lo Barnechea',8),
  ('Phillip Acosta','$80.00','Lorient',19),
  ('Rana Mcknight','$75.22','Tarnów',12),
  ('Galvin Campos','$64.91','Heusden',6),
  ('Cyrus Goodwin','$76.49','Newquay',2),
  ('Marcia Mayo','$91.57','Shimoga',1),
  ('Lacota Nichols','$9.53','Musson',13),
  ('Martina Mathis','$16.14','Central Jakarta',16),
  ('Barclay Ramirez','$16.00','Sagamu',18),
  ('Maxwell Greer','$66.25','Nagar',11),
  ('Sawyer Roth','$53.53','Alingsås',7),
  ('Angelica Whitney','$21.77','Alto del Carmen',21),
  ('Noelle Morris','$45.08','Almere',7),
  ('Lysandra Atkins','$65.98','Ghotki',7),
  ('Jelani Ashley','$43.35','Clydebank',21),
  ('Holmes Frazier','$34.24','Sens',13),
  ('Serena Bryan','$75.23','Shandong',12),
  ('Martin Newton','$41.63','Tejar',20),
  ('Alden Nguyen','$9.35','Stalowa Wola',1),
  ('Kay Buck','$9.54','Gliwice',15),
  ('Quintessa Carson','$86.63','Yogyakarta',9),
  ('Talon Mcgowan','$64.02','Telde',19),
  ('Aretha Gardner','$18.34','Mérida',11),
  ('Chester Haney','$97.56','Veracruz',4),
  ('Courtney Ramsey','$14.74','Osnabrück',2),
  ('Raja Michael','$78.45','Qinghai',13),
  ('Price Yates','$92.97','Liaoning',21),
  ('Adrienne Calhoun','$78.21','Esslingen',20),
  ('Reuben Chaney','$31.58','Vị Thanh',8),
  ('Thaddeus Fischer','$98.18','Aydın',20),
  ('Glenna Chen','$21.06','León',10),
  ('Lani Mack','$78.10','Ørsta',12),
  ('Ciaran Wilkerson','$77.09','Gojal Upper Hunza',18),
  ('Zoe Mercado','$26.41','Mocoa',15),
  ('Nell Matthews','$7.17','Hoa Sơn',20),
  ('Adena Kirby','$18.51','Dublin',1),
  ('Jescie Bates','$50.16','Pleiku',23),
  ('Joshua Fernandez','$1.70','Nässjö',20),
  ('Kasper Thomas','$42.44','O''Higgins',6),
  ('Paloma Dickerson','$94.22','Hermosillo',19),
  ('Tamara Mcdaniel','$65.01','Limón (Puerto Limón]',5),
  ('Stacey Jacobson','$57.27','Pachuca',7),
  ('Hadley Kaufman','$60.61','Naarden',18),
  ('Barrett Mcdowell','$99.29','Quesada',19),
  ('Lenore Grimes','$48.91','Ulm',15),
  ('Scarlet Keller','$16.44','Graz',6),
  ('Winter Hahn','$91.88','Hunstanton',7),
  ('Mariam Randolph','$99.76','Wyoming',13),
  ('Ciaran Hudson','$59.17','Bensheim',13),
  ('Mona Patrick','$94.95','Rochester',4);
INSERT INTO [TA_SMS_DETALLE] (seller,total,country,ID_campaign)
VALUES
  ('Hermione Kemp','$62.21','Levin',8),
  ('Tyler Talley','$60.63','Grasse',22),
  ('Whitney Nieves','$3.09','Siquirres',2),
  ('Fritz Perry','$7.58','Stevenage',16),
  ('Fiona Marks','$1.89','Tân An',13),
  ('Josiah Best','$77.78','Oaxaca',14),
  ('Finn Cook','$12.54','Ophain-Bois-Seigneur-Isaac',21),
  ('Rachel Cantu','$26.58','Da Lat',8),
  ('Stella Owens','$94.97','Meerut Cantonment',17),
  ('Ian Hayden','$7.29','Kızılcahamam',13),
  ('Alan Finch','$70.93','Foligno',12),
  ('Vera Hickman','$13.83','Lasbela',6),
  ('Lucius Valenzuela','$3.09','Portsmouth',20),
  ('Hasad Gross','$31.91','Suruç',24),
  ('Cain Hill','$62.06','Palangka Raya',8),
  ('Zachery Duncan','$33.91','Bucaramanga',17),
  ('Raphael Jackson','$88.74','Gilgit',15),
  ('Slade Ayers','$5.13','Smolensk',7),
  ('August Davidson','$59.97','Dadu',17),
  ('Lucy Patton','$64.84','Milano',7),
  ('Joshua Kemp','$22.26','Harstad',9),
  ('Dean Hinton','$45.68','Bandar Lampung',11),
  ('Denise Stevenson','$15.77','Krems an der Donau',13),
  ('Kiara Payne','$67.16','Dublin',22),
  ('Bruno Stevens','$28.39','Cabo de Santo Agostinho',14),
  ('Alec Mckinney','$45.16','Pontianak',20),
  ('Camden Solomon','$65.32','Parndorf',6),
  ('Jason King','$62.01','Finspång',2),
  ('Jena Richards','$77.29','New Haven',1),
  ('Wanda Ellison','$68.31','Tomohon',7),
  ('Imani Perez','$55.51','Philadelphia',5),
  ('Penelope Wallace','$94.51','Rastatt',8),
  ('Kasimir Stafford','$61.42','Pucón',5),
  ('Bradley Haney','$93.07','Hofors',16),
  ('Melanie Wiggins','$66.30','Springdale',2),
  ('Gabriel O''donnell','$79.19','Dublin',19),
  ('Griffith Estes','$24.20','Whitehorse',6),
  ('Steel Ellison','$96.31','Dublin',12),
  ('Sandra Moore','$36.51','Arequipa',19),
  ('Jameson Brennan','$57.12','Cork',21),
  ('Eaton Adkins','$32.40','Puntarenas',9),
  ('Allen Ellison','$30.38','Rakitnoye',13),
  ('Vivian Justice','$63.05','Sapele',2),
  ('Winter Adkins','$79.95','Okpoko',3),
  ('Kyla Melendez','$38.23','Dokkum',15),
  ('Karly Gamble','$70.76','Hamm',6),
  ('Idona Holman','$8.94','Ålesund',13),
  ('Xandra Pate','$14.28','Thái Nguyên',16),
  ('Noah Monroe','$73.56','Ercolano',24),
  ('Pascale Curry','$10.99','Bengkulu',23);
INSERT INTO [TA_SMS_DETALLE] (seller,total,country,ID_campaign)
VALUES
  ('Omar Perez','$88.55','Oyen',16),
  ('Brady Blankenship','$66.84','Nicoya',3),
  ('Dillon Mcmahon','$69.26','Nagaon',18),
  ('Jacob Bailey','$10.77','Olivar',14),
  ('Paki David','$61.71','Nice',21),
  ('Sophia Davidson','$45.38','Jelenia Góra',9),
  ('Carson Neal','$42.99','Chulucanas',18),
  ('Blythe Shaw','$1.89','Limoges',17),
  ('Jonah Buckner','$42.68','Denpasar',15),
  ('Keegan Evans','$45.23','Ghizer',19),
  ('Kieran Singleton','$97.61','Sete Lagoas',7),
  ('Victor Sampson','$31.00','Panjim',14),
  ('Alexander Morin','$69.92','Saint-Louis',13),
  ('Nigel Hammond','$12.73','Dublin',17),
  ('Ezra Guzman','$81.17','Dublin',15),
  ('Hiram Becker','$59.22','Yeongju',18),
  ('Charlotte Lewis','$90.34','Assiniboia',22),
  ('Devin Fields','$80.58','Bingen',18),
  ('Jerome Hudson','$70.25','Chatteris',20),
  ('Ainsley Schneider','$73.08','Luziânia',17),
  ('Quail Robinson','$95.54','Izmir',4),
  ('Cassady Melton','$62.85','Pencahue',10),
  ('Craig Glass','$84.99','Philadelphia',10),
  ('Liberty Callahan','$89.80','Andong',6),
  ('Dorian Patrick','$67.84','Garzón',18),
  ('Willow Christensen','$23.71','Jecheon',16),
  ('Hu Fernandez','$44.31','Ludvika',16),
  ('Shelly Cohen','$76.18','Burg',17),
  ('Nichole O''brien','$99.07','Ulsan',20),
  ('Callum Nunez','$13.14','Cheonan',11),
  ('Halla Frank','$41.44','Bama',10),
  ('Jameson Fisher','$34.70','Denbigh',11),
  ('Quyn Mclean','$40.94','Borlänge',8),
  ('Wilma Pitts','$72.48','Puno',2),
  ('Sigourney Walker','$62.80','Vadsø',13),
  ('Neve Gilmore','$73.28','Hérouville-Saint-Clair',24),
  ('Sophia Lynch','$62.70','Dublin',21),
  ('Talon Greer','$0.75','Maryborough',8),
  ('Nola Strong','$18.90','Cork',7),
  ('Jasper Vasquez','$12.14','Hamar',14),
  ('Uriah Fitzpatrick','$43.06','Delicias',24),
  ('George Hardin','$56.30','Querétaro',20),
  ('Rylee Patterson','$18.59','Bauchi',11),
  ('Shelley Bradshaw','$52.33','Ocaña',13),
  ('Shafira Dickson','$90.37','La Plata',24),
  ('Alyssa Jordan','$83.73','Lagos',22),
  ('Noah Stephenson','$44.43','Fujian',21),
  ('Hiram Gordon','$63.27','Saint-Dié-des-Vosges',16),
  ('Reagan Haley','$52.20','Pallavaram',17),
  ('Berk Gibson','$22.21','Dunedin',8);
INSERT INTO [TA_SMS_DETALLE] (seller,total,country,ID_campaign)
VALUES
  ('Elijah Burton','$41.16','Puntarenas',3),
  ('Madaline Forbes','$13.30','Belfast',12),
  ('Hamish Mckee','$8.69','Brunn am Gebirge',7),
  ('David Larson','$33.63','Manukau',14),
  ('Nehru Levy','$43.26','Jalgaon',12),
  ('Slade Alvarado','$60.96','Leicester',1),
  ('Chelsea Vazquez','$38.16','Eindhout',13),
  ('Eleanor Sweeney','$79.91','Hidalgo del Parral',16),
  ('Dennis Daugherty','$70.78','Lipetsk',13),
  ('Mollie Morrison','$54.98','Åkersberga',3),
  ('Signe May','$26.63','Belfast',21),
  ('Drake Heath','$94.19','Paraíso',4),
  ('Xavier Blackwell','$60.28','Sogamoso',20),
  ('Olga Watson','$65.46','Gorzów Wielkopolski',10),
  ('Savannah Juarez','$12.90','Nanterre',22),
  ('Salvador Macias','$92.55','Alphen aan den Rijn',18),
  ('Marshall Macias','$23.37','Huaraz',24),
  ('Mollie Moody','$61.56','Aurora',7),
  ('Petra Morgan','$55.09','Toruń',12),
  ('Shaeleigh Horton','$51.88','Quibdó',9),
  ('Ezra Noble','$64.23','Vị Thanh',22),
  ('Daquan Cummings','$1.87','Las Palmas',14),
  ('Lois Wooten','$24.26','Onitsha',15),
  ('Lucas Walker','$47.03','Shanxi',23),
  ('Kessie Barber','$55.23','Hudiksvall',2),
  ('Griffith Booth','$80.78','Barranca',10),
  ('Hunter Garcia','$61.02','Rạch Giá',14),
  ('Bert May','$51.68','Mexicali',18),
  ('Honorato Melendez','$47.80','Annapolis County',16),
  ('Dalton Harris','$9.93','Vandoeuvre-lès-Nancy',15),
  ('Donovan Mckenzie','$35.61','Masterton',25),
  ('Nehru Wooten','$75.52','Orito',13),
  ('Alfonso Petersen','$12.55','Cáceres',20),
  ('Russell Harper','$66.20','Laakirchen',12),
  ('Emma Herring','$33.08','İskenderun',5),
  ('Beau Glass','$55.28','La Ligua',19),
  ('Camden Buck','$34.69','Puntarenas',13),
  ('Hedy Hampton','$63.31','Cortil-Noirmont',12),
  ('Hilary Shelton','$20.59','Herdersem',7),
  ('Calvin Mayo','$55.14','Tando Muhammad Khan',8),
  ('Micah Pickett','$43.98','Täby',11),
  ('Brianna Green','$79.54','Guizhou',10),
  ('Sierra Finch','$38.16','Introd',15),
  ('Graiden Mooney','$66.53','Mexico City',13),
  ('Heidi James','$59.51','Huaraz',4),
  ('Shaeleigh Wagner','$36.74','Okara',22),
  ('Lunea Lambert','$13.28','Tando Allahyar',18),
  ('Whilemina Butler','$50.39','Darwin',10),
  ('Tara Koch','$37.15','Newark',20),
  ('Ria Parrish','$98.75','Omsk',17);

GO
--SELECT * FROM TA_SMS_DETALLE;

--SELECT * FROM TA_SMS_MAESTRO;


GO
CREATE PROCEDURE sp_get_campaigns_details (
	@fecha Date,
	@skip INT,
	@limit INT
)
AS
BEGIN
SELECT T1.ID_campaign, T1.campaign_name, T1.fecha, T2.country, T2.ID_detalle, T2.seller, T2.total FROM
	(SELECT * FROM [TA_SMS_MAESTRO] as T WHERE T.fecha BETWEEN @fecha AND DATEADD(day, 1, @fecha)) as T1 INNER JOIN [TA_SMS_DETALLE] as T2
	ON T1.ID_campaign = T2.ID_campaign order by T1.ID_campaign OFFSET @skip ROWS FETCH NEXT @limit ROWS ONLY;
END
GO

-- EXECUTE sp_get_campaigns_details N'2021-12-12', 5, 5;
-- EXECUTE sp_get_campaigns_details N'2021-12-12', 0, 10;
